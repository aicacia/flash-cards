var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,i=(e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,s=(t,s)=>{for(var o in s||(s={}))e.call(s,o)&&i(t,o,s[o]);if(n)for(var o of n(s))r.call(s,o)&&i(t,o,s[o]);return t};import{i as o,h as a,k as l,j as u}from"./decks-03deb0ad.js";import{s as h}from"./index-33760531.js";var f=function t(e){if(!e)return e;if("function"==typeof e.toJSON&&(e=e.toJSON()),Array.isArray(e))return e.map(t);if("object"==typeof e){const n={};return Object.keys(e).forEach((r=>n[r]=t(e[r]))),n}return e},c=Object.defineProperty({default:f},"__esModule",{value:!0});var d=function(t,e){const n={};return Object.keys(t).forEach((r=>{t[r]===e[r]&&(n[r]=t[r])})),n},p=Object.defineProperty({default:d},"__esModule",{value:!0});const g={},b=()=>!1;var m=function t(e,n,r=g){if(e===n)return!0;const i=typeof e,s=typeof e;if("number"===i&&"number"===s&&isNaN(e)&&isNaN(n))return!0;if(!e||!n||"object"!==i||"object"!==s||e.constructor!==n.constructor)return!1;if(e.valueOf()!==e)return t(e.valueOf(),n.valueOf(),r);const o=r.shallow?y:t;if("function"==typeof e[Symbol.iterator]){const t=e[Symbol.iterator](),i=n[Symbol.iterator]();let s=t.next(),a=i.next();for(;!s.done&&!a.done;){if(!o(s.value,a.value,r))return!1;s=t.next(),a=i.next()}return s.done===a.done}const a=r.excludeProps?r.excludeProps.has.bind(r.excludeProps):b,l=Object.keys(e),u=Object.keys(n);return(r.partial||l.length===u.length)&&u.every((t=>a(t)||e.hasOwnProperty(t)&&o(n[t],e[t],r)))};function y(t,e){return t===e}var v=Object.defineProperty({default:m},"__esModule",{value:!0});function x(t,e,n,r){if(t===e)return t?[[0,t]]:[];if(null!=n){var i=function(t,e,n){var r="number"==typeof n?{index:n,length:0}:n.oldRange,i="number"==typeof n?null:n.newRange,s=t.length,o=e.length;if(0===r.length&&(null===i||0===i.length)){var a=r.index,l=t.slice(0,a),u=t.slice(a),h=i?i.index:null,f=a+o-s;if((null===h||h===f)&&!(f<0||f>o)){var c=e.slice(0,f);if((g=e.slice(f))===u){var d=Math.min(a,f);if((m=l.slice(0,d))===(v=c.slice(0,d)))return P(m,l.slice(d),c.slice(d),u)}}if(null===h||h===a){var p=a,g=(c=e.slice(0,p),e.slice(p));if(c===l){var b=Math.min(s-p,o-p);if((y=u.slice(u.length-b))===(x=g.slice(g.length-b)))return P(l,u.slice(0,u.length-b),g.slice(0,g.length-b),y)}}}if(r.length>0&&i&&0===i.length){var m=t.slice(0,r.index),y=t.slice(r.index+r.length);if(!(o<(d=m.length)+(b=y.length))){var v=e.slice(0,d),x=e.slice(o-b);if(m===v&&y===x)return P(m,t.slice(d,s-b),e.slice(d,o-b),y)}}return null}(t,e,n);if(i)return i}var s=k(t,e),o=t.substring(0,s);s=j(t=t.substring(s),e=e.substring(s));var a=t.substring(t.length-s),l=function(t,e){var n;if(!t)return[[1,e]];if(!e)return[[-1,t]];var r=t.length>e.length?t:e,i=t.length>e.length?e:t,s=r.indexOf(i);if(-1!==s)return n=[[1,r.substring(0,s)],[0,i],[1,r.substring(s+i.length)]],t.length>e.length&&(n[0][0]=n[2][0]=-1),n;if(1===i.length)return[[-1,t],[1,e]];var o=function(t,e){var n=t.length>e.length?t:e,r=t.length>e.length?e:t;if(n.length<4||2*r.length<n.length)return null;function i(t,e,n){for(var r,i,s,o,a=t.substring(n,n+Math.floor(t.length/4)),l=-1,u="";-1!==(l=e.indexOf(a,l+1));){var h=k(t.substring(n),e.substring(l)),f=j(t.substring(0,n),e.substring(0,l));u.length<f+h&&(u=e.substring(l-f,l)+e.substring(l,l+h),r=t.substring(0,n-f),i=t.substring(n+h),s=e.substring(0,l-f),o=e.substring(l+h))}return 2*u.length>=t.length?[r,i,s,o,u]:null}var s,o,a,l,u,h=i(n,r,Math.ceil(n.length/4)),f=i(n,r,Math.ceil(n.length/2));if(!h&&!f)return null;s=f?h&&h[4].length>f[4].length?h:f:h;t.length>e.length?(o=s[0],a=s[1],l=s[2],u=s[3]):(l=s[0],u=s[1],o=s[2],a=s[3]);var c=s[4];return[o,a,l,u,c]}(t,e);if(o){var a=o[0],l=o[1],u=o[2],h=o[3],f=o[4],c=x(a,u),d=x(l,h);return c.concat([[0,f]],d)}return function(t,e){for(var n=t.length,r=e.length,i=Math.ceil((n+r)/2),s=i,o=2*i,a=new Array(o),l=new Array(o),u=0;u<o;u++)a[u]=-1,l[u]=-1;a[s+1]=0,l[s+1]=0;for(var h=n-r,f=h%2!=0,c=0,d=0,p=0,g=0,b=0;b<i;b++){for(var m=-b+c;m<=b-d;m+=2){for(var y=s+m,v=(O=m===-b||m!==b&&a[y-1]<a[y+1]?a[y+1]:a[y-1]+1)-m;O<n&&v<r&&t.charAt(O)===e.charAt(v);)O++,v++;if(a[y]=O,O>n)d+=2;else if(v>r)c+=2;else if(f){if((j=s+h-m)>=0&&j<o&&-1!==l[j])if(O>=(k=n-l[j]))return _(t,e,O,v)}}for(var x=-b+p;x<=b-g;x+=2){for(var k,j=s+x,L=(k=x===-b||x!==b&&l[j-1]<l[j+1]?l[j+1]:l[j-1]+1)-x;k<n&&L<r&&t.charAt(n-k-1)===e.charAt(r-L-1);)k++,L++;if(l[j]=k,k>n)g+=2;else if(L>r)p+=2;else if(!f){if((y=s+h-x)>=0&&y<o&&-1!==a[y]){var O;v=s+(O=a[y])-y;if(O>=(k=n-k))return _(t,e,O,v)}}}}return[[-1,t],[1,e]]}(t,e)}(t=t.substring(0,t.length-s),e=e.substring(0,e.length-s));return o&&l.unshift([0,o]),a&&l.push([0,a]),L(l,r),l}function _(t,e,n,r){var i=t.substring(0,n),s=e.substring(0,r),o=t.substring(n),a=e.substring(r),l=x(i,s),u=x(o,a);return l.concat(u)}function k(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,s=0;n<i;)t.substring(s,i)==e.substring(s,i)?s=n=i:r=i,i=Math.floor((r-n)/2+n);return O(t.charCodeAt(i-1))&&i--,i}function j(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,s=0;n<i;)t.substring(t.length-i,t.length-s)==e.substring(e.length-i,e.length-s)?s=n=i:r=i,i=Math.floor((r-n)/2+n);return w(t.charCodeAt(t.length-i))&&i--,i}function L(t,e){t.push([0,""]);for(var n,r=0,i=0,s=0,o="",a="";r<t.length;)if(r<t.length-1&&!t[r][1])t.splice(r,1);else switch(t[r][0]){case 1:s++,a+=t[r][1],r++;break;case-1:i++,o+=t[r][1],r++;break;case 0:var l=r-s-i-1;if(e){if(l>=0&&A(t[l][1])){var u=t[l][1].slice(-1);if(t[l][1]=t[l][1].slice(0,-1),o=u+o,a=u+a,!t[l][1]){t.splice(l,1),r--;var h=l-1;t[h]&&1===t[h][0]&&(s++,a=t[h][1]+a,h--),t[h]&&-1===t[h][0]&&(i++,o=t[h][1]+o,h--),l=h}}if(M(t[r][1])){u=t[r][1].charAt(0);t[r][1]=t[r][1].slice(1),o+=u,a+=u}}if(r<t.length-1&&!t[r][1]){t.splice(r,1);break}if(o.length>0||a.length>0){o.length>0&&a.length>0&&(0!==(n=k(a,o))&&(l>=0?t[l][1]+=a.substring(0,n):(t.splice(0,0,[0,a.substring(0,n)]),r++),a=a.substring(n),o=o.substring(n)),0!==(n=j(a,o))&&(t[r][1]=a.substring(a.length-n)+t[r][1],a=a.substring(0,a.length-n),o=o.substring(0,o.length-n)));var f=s+i;0===o.length&&0===a.length?(t.splice(r-f,f),r-=f):0===o.length?(t.splice(r-f,f,[1,a]),r=r-f+1):0===a.length?(t.splice(r-f,f,[-1,o]),r=r-f+1):(t.splice(r-f,f,[-1,o],[1,a]),r=r-f+2)}0!==r&&0===t[r-1][0]?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,s=0,i=0,o="",a=""}""===t[t.length-1][1]&&t.pop();var c=!1;for(r=1;r<t.length-1;)0===t[r-1][0]&&0===t[r+1][0]&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)===t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),c=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),c=!0)),r++;c&&L(t,e)}function O(t){return t>=55296&&t<=56319}function w(t){return t>=56320&&t<=57343}function M(t){return w(t.charCodeAt(0))}function A(t){return O(t.charCodeAt(t.length-1))}function P(t,e,n,r){return A(t)||M(r)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[0,t],[-1,e],[1,n],[0,r]])}function I(t,e,n){return x(t,e,n,!0)}I.INSERT=1,I.DELETE=-1,I.EQUAL=0;var S=I,N=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const E=N(v),R=N(c);var T,F;function D(t){return t===Object(t)&&!Array.isArray(t)}(F=T||(T={})).compose=function t(e={},n={},r){"object"!=typeof e&&(e={}),"object"!=typeof n&&(n={});let i=R.default(n);for(const s in e)D(e[s])&&D(i[s])&&(i[s]=t(e[s],i[s],r));r||(i=Object.keys(i).reduce(((t,e)=>(null!=i[e]&&(t[e]=i[e]),t)),{}));for(const s in e)void 0!==e[s]&&void 0===n[s]&&(i[s]=e[s]);return Object.keys(i).length>0?i:void 0},F.diff=function t(e={},n={}){"object"!=typeof e&&(e={}),"object"!=typeof n&&(n={});const r=Object.keys(e).concat(Object.keys(n)).reduce(((r,i)=>(E.default(e[i],n[i])||(void 0===n[i]?r[i]=null:D(e[i])&&D(n[i])?r[i]=t(e[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(r).length>0?r:void 0},F.invert=function t(e={},n={}){e=e||{};const r=Object.keys(n).reduce(((r,i)=>(E.default(n[i],e[i])||void 0===e[i]||(D(e[i])&&D(n[i])?r[i]=t(e[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(e).reduce(((t,r)=>(e[r]!==n[r]&&void 0===n[r]&&(t[r]=null),t)),r)},F.transform=function t(e,n,r=!1){if("object"!=typeof e)return n;if("object"!=typeof n)return;if(!r)return n;const i=Object.keys(n).reduce(((r,i)=>(void 0===e[i]?r[i]=n[i]:D(e[i])&&D(n[i])&&(r[i]=t(e[i],n[i],!0)),r)),{});return Object.keys(i).length>0?i:void 0};var z=T,C=Object.defineProperty({default:z},"__esModule",{value:!0});const q=(o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}})(H);var J=class{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);const e=this.ops[this.index];if(e){const n=this.offset,r=q.default.length(e);if(t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t,"number"==typeof e.delete)return{delete:t};{if(r===t)return e;const i={};return e.attributes&&(i.attributes=e.attributes),"number"==typeof e.retain?i.retain=t:"string"==typeof e.insert?i.insert=e.insert.substr(n,t):i.insert=e.insert,i}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?q.default.length(this.ops[this.index])-this.offset:1/0}peekType(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const t=this.offset,e=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=t,this.index=e,[n].concat(r)}}return[]}},W=Object.defineProperty({default:J},"__esModule",{value:!0});const B=(o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}})(W);var Q,U;(U=Q||(Q={})).iterator=function(t){return new B.default(t)},U.length=function(t){return"number"==typeof t.delete?t.delete:"number"==typeof t.retain?t.retain:"string"==typeof t.insert?t.insert.length:1};var G=Q,H=Object.defineProperty({default:G},"__esModule",{value:!0}),K=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const V=K(S),X=K(v),Y=K(C),Z=K(H),$=String.fromCharCode(0);class tt{constructor(t){Array.isArray(t)?this.ops=t:null!=t&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]}insert(t,e){const n={};return"string"==typeof t&&0===t.length?this:(n.insert=t,null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n))}delete(t){return t<=0?this:this.push({delete:t})}retain(t,e){if(t<=0)return this;const n={retain:t};return null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n)}push(t){let e=this.ops.length,n=this.ops[e-1];if("object"==typeof n){if("number"==typeof t.delete&&"number"==typeof n.delete)return this.ops[e-1]={delete:n.delete+t.delete},this;if("number"==typeof n.delete&&null!=t.insert&&(e-=1,n=this.ops[e-1],"object"!=typeof n))return this.ops.unshift(t),this;if(X.default(t.attributes,n.attributes)){if("string"==typeof t.insert&&"string"==typeof n.insert)return this.ops[e-1]={insert:n.insert+t.insert},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this;if("number"==typeof t.retain&&"number"==typeof n.retain)return this.ops[e-1]={retain:n.retain+t.retain},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this}}return e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),this}chop(){const t=this.ops[this.ops.length-1];return t&&t.retain&&!t.attributes&&this.ops.pop(),this}filter(t){return this.ops.filter(t)}forEach(t){this.ops.forEach(t)}map(t){return this.ops.map(t)}partition(t){const e=[],n=[];return this.forEach((r=>{(t(r)?e:n).push(r)})),[e,n]}reduce(t,e){return this.ops.reduce(t,e)}changeLength(){return this.reduce(((t,e)=>e.insert?t+Z.default.length(e):e.delete?t-e.delete:t),0)}length(){return this.reduce(((t,e)=>t+Z.default.length(e)),0)}slice(t=0,e=1/0){const n=[],r=Z.default.iterator(this.ops);let i=0;for(;i<e&&r.hasNext();){let s;i<t?s=r.next(t-i):(s=r.next(e-i),n.push(s)),i+=Z.default.length(s)}return new tt(n)}compose(t,e){const n=Z.default.iterator(this.ops),r=Z.default.iterator(t.ops),i=[],s=r.peek();if(null!=s&&"number"==typeof s.retain&&null==s.attributes){let t=s.retain;for(;"insert"===n.peekType()&&n.peekLength()<=t;)t-=n.peekLength(),i.push(n.next());s.retain-t>0&&r.next(s.retain-t)}const o=new tt(i);for(;n.hasNext()||r.hasNext();)if("insert"===r.peekType())o.push(r.next());else if("delete"===n.peekType())o.push(n.next());else{const t=Math.min(n.peekLength(),r.peekLength()),i=n.next(t),s=r.next(t);if("number"==typeof s.retain){let a;const l=s.attributes&&Y.default.compose(i.attributes,s.attributes,!e&&"number"==typeof i.retain);if(s.attributes&&!X.default(l,i.attributes)?(a={},"number"==typeof i.retain?a.retain=t:a.insert=i.insert,l&&(a.attributes=l)):a=i.retain===1/0?s:i,o.push(a),s.retain===1/0||!r.hasNext()&&X.default(o.ops[o.ops.length-1],a)){const t=new tt(n.rest());return o.concat(t).chop()}}else"number"==typeof s.delete&&"number"==typeof i.retain&&o.push(s)}return o.chop()}concat(t){const e=new tt(this.ops.slice());return t.ops.length>0&&(e.push(t.ops[0]),e.ops=e.ops.concat(t.ops.slice(1))),e}diff(t,e){if(this.ops===t.ops)return new tt;const n=[this,t].map((e=>e.map((n=>{if(null!=n.insert)return"string"==typeof n.insert?n.insert:$;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")})).join(""))),r=new tt,i=V.default(n[0],n[1],e),s=Z.default.iterator(this.ops),o=Z.default.iterator(t.ops);return i.forEach((t=>{let e=t[1].length;for(;e>0;){let n=0;switch(t[0]){case V.default.INSERT:n=Math.min(o.peekLength(),e),r.push(o.next(n));break;case V.default.DELETE:n=Math.min(e,s.peekLength()),s.next(n),r.delete(n);break;case V.default.EQUAL:n=Math.min(s.peekLength(),o.peekLength(),e);const t=s.next(n),i=o.next(n);X.default(t.insert,i.insert)?r.retain(n,Y.default.diff(t.attributes,i.attributes)):r.push(i).delete(n)}e-=n}})),r.chop()}eachLine(t,e="\n"){const n=Z.default.iterator(this.ops);let r=new tt,i=0;for(;n.hasNext();){if("insert"!==n.peekType())return;const s=n.peek(),o=Z.default.length(s)-n.peekLength(),a="string"==typeof s.insert?s.insert.indexOf(e,o)-o:-1;if(a<0)r.push(n.next());else if(a>0)r.push(n.next(a));else{if(!1===t(r,n.next(1).attributes||{},i))return;i+=1,r=new tt}}r.length()>0&&t(r,{},i,!0)}invert(t){const e=new tt;return this.reduce(((n,r)=>{if(r.insert)e.delete(Z.default.length(r));else{if(r.retain&&null==r.attributes)return e.retain(r.retain),n+r.retain;if(r.delete||r.retain&&r.attributes){const i=r.delete||r.retain;return t.slice(n,n+i).forEach((t=>{r.delete?e.push(t):r.retain&&r.attributes&&e.retain(Z.default.length(t),Y.default.invert(r.attributes,t.attributes))})),n+i}}return n}),0),e.chop()}transform(t,e=!1){if(e=!!e,"number"==typeof t)return this.transformPosition(t,e);const n=t,r=Z.default.iterator(this.ops),i=Z.default.iterator(n.ops),s=new tt;for(;r.hasNext()||i.hasNext();)if("insert"!==r.peekType()||!e&&"insert"===i.peekType())if("insert"===i.peekType())s.push(i.next());else{const t=Math.min(r.peekLength(),i.peekLength()),n=r.next(t),o=i.next(t);if(n.delete)continue;o.delete?s.push(o):s.retain(t,Y.default.transform(n.attributes,o.attributes,e))}else s.retain(Z.default.length(r.next()));return s.chop()}transformPosition(t,e=!1){e=!!e;const n=Z.default.iterator(this.ops);let r=0;for(;n.hasNext()&&r<=t;){const i=n.peekLength(),s=n.peekType();n.next(),"delete"!==s?("insert"===s&&(r<t||!e)&&(t+=i),r+=i):t-=Math.min(i,t-r)}return t}}tt.Op=Z.default,tt.AttributeMap=Y.default;var et=tt,nt=Object.defineProperty({default:et},"__esModule",{value:!0}),rt=a((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeRange=void 0,e.normalizeRange=function(t){return t?(t[0]>t[1]&&(t=[t[1],t[0]]),t):t}})),it=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const st=it(nt),ot=it(mt);var at=class{constructor(t){this.lines=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);const e=this.lines[this.index];if(e){const n=this.offset,r=e.length;return t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t,0===n&&t>=e.length?e:ot.default.create(e.content.slice(n,t),e.attributes)}return ot.default.create(new st.default([{retain:1/0}]))}peek(){return this.lines[this.index]}peekLength(){return this.lines[this.index]?this.lines[this.index].length-this.offset:1/0}rest(){if(this.hasNext()){if(0===this.offset)return this.lines.slice(this.index);{const t=this.offset,e=this.index,n=this.next(),r=this.lines.slice(this.index);return this.offset=t,this.index=e,[n].concat(r)}}return[]}},lt=Object.defineProperty({default:at},"__esModule",{value:!0}),ut=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const ht=ut(nt),ft=ut(lt),ct=ut(v),dt={},pt=new WeakMap;var gt;!function(t){function i(t){return t.attributes.id}function o(t=dt){let e;for(;t[e=Math.random().toString(36).slice(2)];);return e}t.iterator=function(t){return new ft.default(t)},t.length=function(t){return t.length},t.getId=i,t.equal=function(t,e){return ct.default(t.attributes,e.attributes)&&ct.default(t.content.ops,e.content.ops)},t.fromDelta=function(e,n=dt){const r=[];return e.eachLine(((e,i)=>{r.push(t.create(e,Object.keys(i).length?i:void 0,n))})),r},t.toDelta=function(t,i){let s=new ht.default;return t.forEach((t=>{s=s.concat(t.content);let o=t.attributes;if(!i){const{id:t}=o;o=((t,i)=>{var s={};for(var o in t)e.call(t,o)&&i.indexOf(o)<0&&(s[o]=t[o]);if(null!=t&&n)for(var o of n(t))i.indexOf(o)<0&&r.call(t,o)&&(s[o]=t[o]);return s})(o,["id"])}s.insert("\n",o)})),s},t.create=function(t=new ht.default,e={},n=dt){const r=t.length()+1;return e.id||(e=s(s({},e),{id:o(n)})),{attributes:e,content:t,length:r}},t.getLineInfo=function(t){let e=pt.get(t);if(!e){const n=new Map,r={};let s=0;t.forEach((t=>{r[i(t)]=t,n.set(t,[s,s+=t.length])})),e={ranges:n,ids:r},pt.set(t,e)}return e},t.createId=o}(gt||(gt={}));var bt=gt,mt=Object.defineProperty({default:bt},"__esModule",{value:!0}),yt=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const vt=yt(lt),xt=yt(W),_t=yt(mt),kt=yt(H);var jt,Lt;(Lt=jt||(jt={})).iterator=function(t){return new wt(t)},Lt.length=kt.default.length;var Ot=jt;class wt{constructor(t){this.lineIterator=new vt.default(t);const e=this.lineIterator.peek();this.opsIterator=new xt.default((null==e?void 0:e.content.ops)||[])}hasNext(){return this.opsIterator.hasNext()||this.lineIterator.hasNext()}skip(t){let e=0;for(;this.lineIterator.peekLength()<t;){const n=_t.default.length(this.nextLine());t-=n,e+=n}return e}next(t){let e=this.opsIterator.next(t);if(e.retain===1/0){e={insert:"\n"};const t=this.nextLine();t.attributes&&(e.attributes=t.attributes)}return e}nextLine(){const t=this.lineIterator.next(),e=this.lineIterator.peek();return this.opsIterator=new xt.default((null==e?void 0:e.content.ops)||[]),t}peek(){return this.opsIterator.peek()}peekLength(){return this.opsIterator.peekLength()}}var Mt=Object.defineProperty({default:Ot},"__esModule",{value:!0}),At=a((function(t,e){var n=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.hasFormat=void 0;const r=n(C),i=n(nt),a=n(mt),l=n(p),u=n(v);class h{constructor(t,e=new i.default,n){this._pos=0,this.doc=t,this.delta=e,this.selection=n}get contentChanged(){return this.delta.ops.length>0}get selectionChanged(){var t;return void 0!==this.selection&&!u.default(this.selection,null===(t=this.doc)||void 0===t?void 0:t.selection)}apply(){}setDelta(t){this.delta=t,this._pos=t.length()}select(t){return this.selection="number"==typeof t?[t,t]:t,this}delete(t,e){if(!t||!this.doc)return this;const[n,r]=rt.normalizeRange(t);if(n===r)return this;const i=r-n;this.doc.selection&&(this.selection=[n,n]),this.compose(n,(t=>t.delete(i)),i);const s=this.doc.getLineRange(n);return!(null==e?void 0:e.dontFixNewline)&&s[1]<=r&&this.formatLine(r,this.doc.getLineFormat(n)),this}insert(t,e,n,r){if(!this.doc)return this;if(t=this.normalizePoint(t),this.doc.selection){const n=t+("string"==typeof e?e.length:1);this.selection=[n,n]}const i=this.doc.byId,o=this.doc.getLineFormat(t);if("string"!=typeof e)this.compose(t,(t=>t.insert(e,n)));else if("\n"===e)(null==r?void 0:r.dontFixNewline)?this.compose(t,(t=>t.insert("\n",s(s({},n),{id:a.default.createId(i)})))):(this.compose(t,(t=>t.insert("\n",o))),this.formatLine(t,s(s({},n),{id:a.default.createId(i)})));else{n||(n=this.getFormatAt(t));const r=e.split("\n");r.forEach(((e,r)=>{r&&this.compose(t,(t=>t.insert("\n",1===r?o:{id:a.default.createId(i)}))),e.length&&this.compose(t,(t=>t.insert(e,n)))})),r.length>1&&o&&this.formatLine(t,s(s({},o),{id:a.default.createId(i)}))}return this}insertContent(t,e){return this.doc?(t=this.normalizePoint(t),this.compose(t,(t=>t.concat(e))),this):this}formatText(t,e){if(!this.doc)return this;return(t=rt.normalizeRange(t))[1]-t[0]?(e&&Object.keys(e).forEach((t=>!1===e[t]&&(e[t]=null))),this.doc.getLineRanges(t).forEach((([n,r])=>{n=Math.max(t[0],n);const i=(r=Math.min(t[1],r-1))-n;this.compose(n,(t=>t.retain(i,e)),i)})),this):this}toggleTextFormat(t,e){if(!this.doc)return this;"number"==typeof t&&(t=[t,t]),t=rt.normalizeRange(t);return f(e,this.doc.getTextFormat(t))&&(e=r.default.invert(e)),this.formatText(t,e)}formatLine(t,e,n){if(!this.doc)return this;const i=this.doc;return"number"==typeof t&&(t=[t,t]),t=rt.normalizeRange(t),this.doc.getLineRanges(t).forEach((([t,o])=>{if(o--,!n){const t=r.default.invert(i.getLineFormat(o));delete t.id,e=s(s({},t),e)}this.compose(o,(t=>t.retain(1,e)),1)})),this}toggleLineFormat(t,e){if(!this.doc)return this;"number"==typeof t&&(t=[t,t]),t=rt.normalizeRange(t);return f(e,this.doc.getLineFormat(t))&&(e=r.default.invert(e)),this.formatLine(t,e)}removeFormat(t){if(!this.doc)return this;t=rt.normalizeRange(t);const e=r.default.invert(this.doc.getFormats(t)),n=t[1]-t[0];return this.compose(t[0],(t=>t.retain(n,e)),n)}transform(t,e){const n=this.delta.transform(t.delta,e),r=t.selection&&this.transformSelection(t.selection);return new h(null,n,r)}transformSelection(t,e){if(!t)return t;const n=this.delta.transformPosition(t[0],e),r=this.delta.transformPosition(t[1],e);return n===t[0]&&r===t[1]?t:[n,r]}transformAgainst(t,e){return(t instanceof i.default?new h(null,t):t).transform(this,!e)}isFor(t){return this.doc===t}clone(){var t;return new h(this.doc,new i.default(this.delta.ops.slice()),null===(t=this.selection)||void 0===t?void 0:t.slice())}compose(t,e,n){return this._pos<=t?this.delta=e(this.delta.retain(t-this._pos)):this.delta=this.delta.compose(e((new i.default).retain(t))),this._pos=Math.max(t+(n||0),this._pos),this}normalizePoint(t,e=(this.doc?this.doc.length-1:0)){return Math.max(0,Math.min(e,t))}getFormatAt(t){let e;if(this.doc){const n=this.doc.getTextFormat(t),r=this.doc.getTextFormat(t+1);n&&r&&(e=n===r?n:l.default(r,Object.keys(n)))}return e}}function f(t,e){return Object.keys(t).every((n=>e[n]===t[n]))}e.default=h,e.hasFormat=f})),Pt=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const It=Pt(v),St=Pt(nt),Nt=Pt(H),Et=Pt(mt),Rt=Pt(Mt),Tt=Pt(C),Ft=Pt(At),Dt=[0,0],zt={},Ct=new WeakMap,qt=new WeakMap,Jt=new Set(["id"]);class Wt{constructor(t,e=null){Array.isArray(t)?this.lines=t:this.lines=t?Et.default.fromDelta(t):[Et.default.create()],this.lines.length||this.lines.push(Et.default.create());const n=Et.default.getLineInfo(this.lines);this._ranges=n.ranges,this.byId=n.ids,this.length=this.lines.reduce(((t,e)=>t+e.length),0),this.selection=e&&e.map((t=>Math.min(this.length-1,Math.max(0,t))))}get change(){const t=new Ft.default(this);return t.apply=()=>this.apply(t),t}getText(t){return t&&(t=rt.normalizeRange(t)),(t?this.slice(t[0],t[1]):this.slice(0,this.length-1)).map((t=>"string"==typeof t.insert?t.insert:" ")).join("")}getLineBy(t){return this.byId[t]}getLineAt(t){return this.lines.find((e=>{const[n,r]=this.getLineRange(e);return n<=t&&r>t}))}getLinesAt(t,e){let n=t;return Array.isArray(t)&&([t,n]=rt.normalizeRange(t)),this.lines.filter((r=>{const[i,s]=this.getLineRange(r);return e?i>=t&&s<=n:i<=n&&s>t}))}getLineRange(t){const{lines:e,_ranges:n}=this;if("number"==typeof t){for(let r=0;r<e.length;r++){const i=n.get(e[r])||Dt;if(i[0]<=t&&i[1]>t)return i}return Dt}return"string"==typeof t&&(t=this.getLineBy(t)),n.get(t)}getLineRanges(t){return null==t?Array.from(this._ranges.values()):this.getLinesAt(t).map((t=>this.getLineRange(t)))}getLineFormat(t){let e=t;return Array.isArray(t)&&([t,e]=rt.normalizeRange(t)),t===e&&e++,Qt(Et.default,this.lines,t,e)}getTextFormat(t){let e=t;return Array.isArray(t)&&([t,e]=rt.normalizeRange(t)),t===e&&t--,Qt(Rt.default,this.lines,t,e,(t=>"\n"!==t.insert))}getFormats(t){return s(s({},this.getTextFormat(t)),this.getLineFormat(t))}slice(t=0,e=1/0){const n=[],r=Rt.default.iterator(this.lines);let i=0;for(;i<e&&r.hasNext();){let s;i<t?s=r.next(t-i):(s=r.next(e-i),n.push(s)),i+=Nt.default.length(s)}return new St.default(n)}apply(t,e){let n;if(t instanceof Ft.default?(n=t.delta,e=t.selection):n=t,!n.ops.length&&(void 0===e||It.default(this.selection,e)))return this;if(!n.ops.length&&e)return new Wt(this.lines,e);void 0===e&&this.selection&&(e=[n.transformPosition(this.selection[0]),n.transformPosition(this.selection[1])],It.default(this.selection,e)&&(e=this.selection));const r=Et.default.iterator(this.lines),i=Nt.default.iterator(n.ops);let s=[];const o=i.peek();if(o&&o.retain&&!o.attributes){let t=o.retain;for(;r.peekLength()<=t;)t-=r.peekLength(),s.push(r.next());o.retain-t>0&&i.next(o.retain-t)}0===i.index&&0===i.offset||(n=new St.default(i.rest()));const a=[];let l=n.reduce(((t,e)=>t+(e.insert?0:Nt.default.length(e))),0);for(;r.peekLength()<=l;)l-=r.peekLength(),a.push(r.next());l>=0&&a.push(r.next());const u=function(t,e,n){return Et.default.fromDelta(Et.default.toDelta(e,!0).compose(t,!0)).map((t=>{const e=Et.default.getId(t),r=n[e];return r&&Et.default.equal(r,t)?r:t}))}(n,a,this.byId);return u.length===a.length&&u.every(((t,e)=>t===a[e]))?this.selection===e?this:new Wt(this.lines,e):(s=s.concat(u),s=s.concat(r.rest()),new Wt(s,e))}replace(t,e){return new Wt(t,e)}toDelta(t){const e=t?qt:Ct;let n=e.get(this);return n||(n=Et.default.toDelta(this.lines,t),e.set(this,n)),n}equals(t,e){return this===t||((null==e?void 0:e.contentOnly)||It.default(this.selection,t.selection))&&It.default(this.lines,t.lines,{excludeProps:Jt})}toJSON(){return this.toDelta()}toString(){return this.lines.map((t=>t.content.map((t=>"string"==typeof t.insert?t.insert:" ")).join(""))).join("\n")+"\n"}}var Bt=Wt;function Qt(t,e,n,r,i){const o=t.iterator(e);let a,l=0;for(o.skip&&(l+=o.skip(n));l<r&&o.hasNext();){let e=o.next();l+=t.length(e),l>n&&(!i||i(e))&&(e.attributes?a?a=Ut(a,e.attributes):(a=s({},e.attributes),a&&delete a.id):a={})}return a||zt}function Ut(t,e){return Object.keys(e).reduce((function(n,r){return t[r]===e[r]&&(n[r]=t[r]),n}),{})}window.AttributeMap=Tt.default;var Gt=Object.defineProperty({default:Bt},"__esModule",{value:!0}),Ht=l(h),Kt=a((function(t,e){var n=o&&o.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.proxy=e.rootStore=e.focusStore=e.selectionStore=e.docStore=e.activeStore=e.editorStores=void 0;const r=n(Gt),i=n(v),s=()=>{},a=Ht.readable({},s),l=Ht.readable(new r.default,s),u=Ht.readable(null,s),h=Ht.readable(void 0,s);function f(t){if(!t)return a;let e=t.getActive();return Ht.readable(e,(n=>{const r=()=>{const r=t.getActive();i.default(e,r)||n(e=r)};return t.on("changed",r),t.on("format",r),()=>{t.off("changed",r),t.off("format",r)}}))}function c(t){return t?Ht.readable(t.doc,(e=>{const n=()=>e(t.doc);return n(),t.on("changed",n),()=>t.off("changed",n)})):l}function d(t){return t?Ht.readable(t.doc.selection,(e=>{const n=()=>e(t.doc.selection);return n(),t.on("changed",n),()=>t.off("changed",n)})):u}function p(t){return Ht.derived(t,(t=>!!t))}function g(t){return t?Ht.readable(t._root,(e=>{const n=()=>e(t._root);return n(),t.on("root",n),()=>t.off("root",n)})):h}function b(t){const e="subscribe"in t?Ht.get(t):t,{set:n,subscribe:r}=Ht.writable(e);let i;function s(t){i&&i(),t&&(i=t.subscribe((t=>n(t))))}return"subscribe"in t&&s(t),{set:s,subscribe:r}}e.editorStores=function(t){const e=b(f(t)),n=b(c(t)),r=b(d(t)),i=b(g(t)),s=p(r);return{active:e,doc:n,selection:r,root:i,focus:s,updateEditor:function(s){s!==t&&(t=s,e.set(f(t)),n.set(c(t)),r.set(d(t)),i.set(g(t)))}}},e.activeStore=f,e.docStore=c,e.selectionStore=d,e.focusStore=p,e.rootStore=g,e.proxy=b})),Vt=u(Kt),Xt=Object.freeze(Object.assign(Object.create(null),Kt,{[Symbol.toStringTag]:"Module",default:Vt}));export{C as A,nt as D,rt as E,W as I,mt as L,H as O,Gt as T,At as a,p as b,c,S as d,Mt as e,lt as f,Kt as g,v as i,Xt as s};
